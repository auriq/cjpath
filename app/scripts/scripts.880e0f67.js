function urlsFactory(a){return{getHelp:"gd.help.php",getContents:"gd.content.php",getOptions:"gd.options.php",getFilters:"gd.filters.php",getCacheQueue:"gd.cachequeue.php",saveFilters:"sv.filters.php",essInstance:"ess.instance.php",essUdbd:"ess.udbd.php",getLogs:"gd.logs.php",getDbs:"gd.db.php",fileManipulation:"mn.file.php"}}function funcCommonFactory(a,b){return{checkIfYouAreHijacked:function(c,d){var e=!1,f=b.defer();return a.essInstance({uid:c,lid:d,dotype:"check",trgtype:"checkifhijacked"}).$promise.then(function(a){var b=a.localisused||"",c=a.wdisused||"";"used"!==b&&"used"!==c||(e=!0),f.resolve(e)}),f.promise}}}!function(){"use strict";angular.module("auriqCJPath",["ngCookies","ngResource","ngSanitize","ngRoute","ngAnimate","ui.bootstrap","flow","nvd3"])}(),function(){"use strict";angular.module("auriqCJPath").constant("API_BASE",apihost)}(),function(){"use strict";function a(a,b,c){a.projects=b.projects,a.uid=b.uid,a.lid=b.lid,a.insttype=b.insttype||"local",a.instnum=b.instnum||"1",a.masterFlg=b.masterFlg,a.islogout=!1}angular.module("auriqCJPath").run(a),a.$inject=["$rootScope","$window","colorsFactory"]}(),function(){"use strict";function a(a){a.when("/landing",{templateUrl:"views/landing.html",controller:"LandingCtrl",controllerAs:"vm",title:"Auriq Dashboard"}).when("/paths",{templateUrl:"views/paths.html",controller:"PathsCtrl",controllerAs:"vm",title:"Auriq Dashboard - Path Report"}).when("/caches",{templateUrl:"views/caches.html",controller:"CachesCtrl",controllerAs:"vm",title:"Auriq Dashboard - Cache Management"}).when("/configs",{templateUrl:"views/configs.html",controller:"ConfigsCtrl",controllerAs:"vm",title:"Auriq Dashboard - Configuration"}).otherwise({redirectTo:"/landing"})}angular.module("auriqCJPath").config(a),a.$inject=["$routeProvider"]}(),angular.module("auriqCJPath").config(["$httpProvider","$sceDelegateProvider","API_BASE",function(a,b,c){b.resourceUrlWhitelist(["self",c+"/**"]),a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;application/json;charset=utf-8",a.defaults.withCredentials=!0}]),function(){"use strict";function a(a,c,d){var e="POST",f=b.bind(null,e),g={};for(var h in d)g[h]=f(d[h]);return a(c+"/:entity",{},g)}function b(a,b,c){return{method:a,isArray:!!c,params:function(){return{entity:b}}()}}angular.module("auriqCJPath").factory("API",a),a.$inject=["$resource","API_BASE","urlsFactory"]}(),angular.module("auriqCJPath").filter("ordinalNumberSuffix",function(){return function(a){var b=["th","st","nd","rd"],c=a;isFinite(c)||(c=parseInt(a.replace("st","")));var d=c%10,e=Math.floor(c/10%10),f=1!==e&&d<b.length-1?b[d]:b[0];return c.toString()+f}}),angular.module("auriqCJPath").factory("d3Service",function(){return{d3:d3}}),function(){"use strict";function a(a,b,c,d,e,f){function g(b,c){return a.getOptions({uid:b,lid:c,opttype:"wordsdict",dtype:"global_panel"}).$promise}function h(b,c){var d,e={global_summary:{pclass:"col-sm-7",include_path:""},cj_paths:{pclass:"col-sm-7",include_path:""}};return d=a.getOptions({uid:b,lid:c,opttype:"global"}).$promise,d.then(function(a){var c=a.contents.data,d=0;angular.forEach(c,function(a,c){var f=a,g=f.type,h=g in e?e[g]:{},j=angular.extend(h,f,{isVisible:!0,isLoaded:!1,data:{},uid:b});i(g,j),m[d]=j,d+=1})}),d}function i(a,b){"contents"in b&&"cj_paths"===a&&n.push(b.contents)}function j(a,b,c,d,e){var f={};return f.cachelist=e.cachelist,f.iscachedexist=e.iscachedexist,f.currentimported=angular.copy(e.currimported),f.userchoice=angular.copy(e.currimported),f.cacheidx=e.cacheidx,f.lang=e.lang,f.uid=a,f.lid=b,f}function k(b,c){return a.essInstance({uid:b,lid:c,dotype:"manipulate",cmdtype:"logout"}).$promise}var l=[],m=[],n=[],o=[];return{optionsList:l,tempParams:o,contentsList:m,cjPathsParams:n,getWordDict:g,getParameters:h,returnInitGlobalParams:j,terminateMyself:k}}angular.module("auriqCJPath").factory("pathsService",a),a.$inject=["API","$q","$window","API_BASE","urlsFactory","colorsFactory"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(b,c,d){return a.essInstance({uid:b,lid:c,dotype:"check",trgtype:d}).$promise}function i(b,c,d,e){return a.essInstance({uid:b,lid:c,dotype:"manipulate",cmdtype:"create",insttype:d,instnum:e}).$promise}function j(a,c){return k(a,c,b.defer())}function k(a,b,c){return h(a,b,"instance").then(function(e){"ready"===e.status?c.resolve(e):d(function(){k(a,b,c)},u)}),c.promise}function l(b,c,d){var e={cmdtype:"import",uid:b,lid:c,cachedir:d.global.userchoice.fname||d.global.cachelist[0].fname,sdate:d.global.userchoice.start_date,edate:d.global.userchoice.end_date,bdays:d.global.userchoice.back_days,sampling:d.global.userchoice.sampling,cpmemo:d.global.userchoice.memo,redoflg:0};return a.essUdbd(e).$promise}function m(a,c){return n(a,c,b.defer())}function n(a,b,c){return h(a,b,"import").then(function(e){"done"===e.status||"failed"===e.status?c.resolve(e):d(function(){n(a,b,c)},u)}),c.promise}function o(b,c,d){var e=p(d.global.filterdiff);return a.saveFilters({uid:b,lid:c,pattern:"global",type:"filter",filterSelection:JSON.stringify(e)}).$promise}function p(a){var b=[];for(var c in a)b=b.concat(a[c]);return b}function q(b,c){return a.essUdbd({uid:b,lid:c,cmdtype:"profile"}).$promise}function r(c,d){var e=b.defer();return a.getFilters({uid:c,lid:d,gettype:"diff"}).$promise.then(function(a){if(!a.data.isExistDiff)return e.resolve();q(c,d).then(function(){return e.resolve()})}),e.promise}function s(b,c){return a.essInstance({uid:b,lid:c,dotype:"manipulate",cmdtype:"takeover",targetdir:"workdir",insttype:"",instnum:""}).$promise}var t=[],u=1e3;return{optionsList:t,getStatus:h,envSetupStart:i,waitEssSetup:j,startImport:l,waitImporting:m,startProfile:q,saveGlobalFilter:o,checkIfFilterIsUpdated:r,takeOverUser:s}}angular.module("auriqCJPath").factory("envService",a),a.$inject=["API","$q","$window","$timeout","API_BASE","urlsFactory","colorsFactory"]}(),angular.module("auriqCJPath").factory("colorsFactory",function(){var a=["#528be8","#c680d2","#45b29d","#35b1fc","#556c90","#ed9859","#84c98a","#f7565a","#2f3f59","#6d4374","#91b6f2","#e8b852"];return{getAll:function(){return a},limit:function(b){if(b>a.length)for(var c=a.slice(0),d=0;d<Math.ceil(b/a.length);d++)a=a.concat(c);return a.slice(0,b)},getColor:function(b){return a[b%a.length]}}}),angular.module("auriqCJPath").factory("urlsFactory",urlsFactory),urlsFactory.$inject=["$resource"],angular.module("auriqCJPath").factory("funcCommonFactory",funcCommonFactory),funcCommonFactory.$inject=["API","$q"],angular.module("auriqCJPath").factory("formatCheckFactory",function(){return{check_date:function(a){var b=a.value;if(""===b)a.iserror=!0,a.message="this field cannot be empty";else if(b.match(/^\d{4}([./-])\d{2}\1\d{2}$/)){var c=b.split("-"),d=c[0],e=c[1],f=c[2];d>1970&&e>=1&&e<=12&&f>=1&&f<=31?(a.iserror=!1,a.message=""):(a.iserror=!0,a.message="invalid format")}else a.iserror=!0,a.message="invalid format"},check_int:function(a){var b=a.value;""===b?(a.iserror=!0,a.message="this field cannot be empty"):b%1==0?(a.iserror=!1,a.message=""):(a.iserror=!0,a.message="invalid format")}}}),angular.module("auriqCJPath").controller("MainCtrl",["$scope","urlsFactory","$rootScope","API","$timeout","$window",function(a,b,c,d,e,f){var g=this;d.getOptions({uid:uid,lid:lid,opttype:"landing"}).$promise.then(function(a){g.availableContentList=a.data}),a.$watch(function(){return{"rootScope.islogout":c.islogout}},function(){g.islogout=c.islogout,g.islogout&&d.getOptions({uid:uid,lid:lid,opttype:"wordsdict",dtype:"loggedout"}).$promise.then(function(a){g.wordsloggedout=a.wordsdict.loggedout})},!0)}]),angular.module("auriqCJPath").controller("LandingCtrl",["$scope","urlsFactory","$rootScope","API","$timeout","$location",function(a,b,c,d,e,f){function g(a){f.path(a.paths.path)}function h(b){var c=!1;for(var d in b)if(!0===b[d].isExist)return c=!0,f.path(b[d].path),!1;a.contentExist=c}a.contentExist=!0,d.getOptions({uid:uid,lid:lid,opttype:"landing"}).$promise.then(function(a){var b=a.data;void 0!==b&&(!0===b.paths.isExist?g(b):h(b))})}]),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){function m(){f.getWordDict(y,z).then(function(a){w.wordsDict=angular.extend({},w.wordsDict,a.wordsdict)}),g.getStatus(y,z,"instance").then(function(a){w.lang=a.lang,w.udbdStatus=a.insttype,w.wordsDict=angular.extend({},w.wordsDict,a.wordsdict),w.envStatus.isDoneInstance="ready"===a.status,w.envStatus.isRunningInstance="creating"===a.status,w.envStatus.isImporting=!!w.envStatus.isDoneInstance&&a.isimporting,w.envStatus.isReadyForApp=!!w.envStatus.isDoneInstance&&a.isimported,w.otherUserStatus.isOccupied=-1===["me","notused"].indexOf(a.wdisused),w.otherUserStatus.isOccupied?(w.envStatus.isReadyForApp=!1,w.appStatus.isLoading=!1):(s(),w.envStatus.isDoneInstance?w.envStatus.isImporting?q():f.getParameters(y,z).then(function(a){n(a),o(),w.appStatus.isLoading=!1,k(function(){w.helps()},2e3)}):w.envStatus.isRunningInstance?p():g.envSetupStart(y,z,A,B).then(function(){p()}))})}function n(b){w.optionsList=b.options,w.contentsList=f.contentsList,a.indexOfContentList=parseInt(e.get("cindex"))||0,a.activeContentObject=angular.copy(w.contentsList[a.indexOfContentList]),w.isAppLoaded=!0}function o(){w.globalParams.global=f.returnInitGlobalParams(y,z,a.masterFlg,a.logtype,w.optionsList),w.globalParams.uid=y,w.globalParams.lid=z,w.globalParams.masterFlg=a.masterFlg,w.globalParams.logtype=a.logtype}function p(){w.envStatus.isRunningInstance=!0,g.waitEssSetup(y,z).then(function(b){w.udbdStatus=b.insttype,w.envStatus.isDoneInstance=!0,w.envStatus.isRunningInstance=!1,f.getParameters(y,z).then(function(b){n(b),o(),a.isDemoProject?g.saveGlobalFilter(y,z,w.globalParams).then(function(){g.startImport(y,z,w.globalParams).then(function(){q()})}):(w.appStatus.isLoading=!1,k(function(){w.helps()},2e3))})})}function q(){w.envStatus.isImporting=!0,w.envStatus.isReadyForApp=!1,w.appStatus.isLoading=!0,g.waitImporting(y,z).then(function(b){w.otherUserStatus.isOccupied?(w.envStatus.isImporting=!1,k(function(){w.helps()},2e3)):"done"===b.status?g.checkIfFilterIsUpdated(y,z).then(function(){w.envStatus.isImporting=!1,w.envStatus.isReadyForApp=!0,w.appStatus.isLoading=!1,g.getStatus(y,z,"instance").then(function(a){w.udbdStatus=a.insttype,k(function(){w.helps()},2e3)}),x&&"global_summary"==a.activeContentObject.type&&a.notifyFilterUpdated++}):"failed"===b.status&&(w.envStatus.isImportFailed=!0,w.importFailedMessage="failed to import data.",w.envStatus.isImporting=!1,w.envStatus.isReadyForApp=!1,w.appStatus.isLoading=!1,g.getStatus(y,z,"instance").then(function(a){w.udbdStatus=a.insttype,k(function(){w.helps()},2e3)}))}),f.getParameters(y,z).then(function(a){n(a),o()})}function r(){return!0}function s(){w.isViewMode=!1,w.stickypanelcss={width:$(d).width()+"px",height:$(d).height()+"px"}}function t(a){clearTimeout(C);var b=angular.element(a.target).closest(".help-target"),c=angular.element(b),d=b[0].getBoundingClientRect(),e=d.top,f=d.left-90,g=d.width,h=d.height;h<10&&(h+=60);var i=c.data("help-title"),j=c.data("help-text"),k=c.data("help-posx"),l=c.data("help-posy"),m=angular.element(document.querySelector("#help-tip-wrapper"));m.show(),angular.element(m.find("h3")).html(i),angular.element(m.find("p")).html(j),m.css({visibility:"hidden"}),m.removeClass(function(a,b){return(b.match(/(^|\s)pos-\S+/g)||[]).join(" ")}),m.addClass("pos-y-"+l),m.addClass("pos-x-"+k);var n=m.outerHeight(),o=m.outerWidth(),p="top"===l?e-n-10:"bottom"===l?e+h+10:e,q="side"!==l?"left"===k?f:f-o+40:"left"===k?f-o-10:f+g+16;m.css({top:p,left:q,visibility:"visible"})}function u(a){clearTimeout(C),C=setTimeout(function(){t(a)},2e3)}function v(a){clearTimeout(C),angular.element(document.querySelector("#help-tip-wrapper")).css({visibility:"hidden"}),angular.element(document.querySelector("#help-tip-wrapper")).hide()}var w=this;w.appStatus={isLoading:!0,message:"Loading..."},w.otherUserStatus={},w.envStatus={isDoneInstance:null,isImporting:null,isImportFailed:null,isReadyForApp:null},w.globalParams={},w.optionsList={},w.wordsDict={},w.isGlobalSelectChanged={},w.isApplyBttnActive=!0,w.udbdStatus={},w.isCollapsed=!0,w.isCollapsedViewSetting=!0,w.isViewMode=!1,w.importFailedMessage="";var x=!1;a.notifyFilterUpdated=0;var y=a.uid,z=a.lid,A=a.insttype,B=a.instnum;a.isDemoProject=-1!==a.projects.indexOf(y),m(),a.dataImportApply=function(){var a=w.envStatus.isReadyForApp;w.envStatus.isImportFailed=!1,w.importFailedMessage="",w.envStatus.isImporting=!0,w.appStatus.isLoading=!0,w.envStatus.isReadyForApp=!1,r()?!0===w.isGlobalSelectChanged.period||!1===a?g.saveGlobalFilter(y,z,w.globalParams).then(function(){g.startImport(y,z,w.globalParams).then(function(){q()})}):(x=!0,g.saveGlobalFilter(y,z,w.globalParams).then(function(){g.startProfile(y,z).then(function(){q()})})):g.startImport(y,z,w.globalParams).then(function(){q()}),w.isGlobalSelectChanged={}},a.filterConditionRefresh=function(){w.envStatus.isReadyForApp;w.envStatus.isImportFailed=!1,w.importFailedMessage="",w.envStatus.isImporting=!0,w.appStatus.isLoading=!0,w.envStatus.isReadyForApp=!1,g.startProfile(y,z).then(function(){q()})},a.$watch(function(){return{isGlobalSelectChanged:w.isGlobalSelectChanged,"envStatus.isReadyForApp":w.envStatus.isReadyForApp}},function(){!0===w.envStatus.isReadyForApp&&(w.isApplyBttnActive=-1!==Object.values(w.isGlobalSelectChanged).indexOf(!0)),!1===w.envStatus.isReadyForApp&&(w.isApplyBttnActive=w.globalParams.global)},!0),a.switchContent=function(b,c){if(!w.isAppLoaded)return!1;a.indexOfContentList!==b&&(e.put("cindex",b),a.indexOfContentList=b,a.activeContentObject=angular.copy(w.contentsList[b]),w.isAppLoaded=!1,k(function(){w.helps()},2e3))},a.switchProjects=function(b){w.appStatus.isLoading=!0,w.envStatus.isReadyForApp=!1,f.terminateMyself(a.uid,a.lid).then(function(){w.envStatus={isDoneInstance:!1,isImporting:!1,isReadyForApp:!1},h.search({uid:b}),c.uid=b,l.reload()})},a.takeOverUser=function(){w.appStatus.isLoading=!0,g.getStatus(y,z,"instance").then(function(a){w.envStatus.isImporting=a.isimporting,w.envStatus.isImporting?(w.appStatus.isLoading=!1,alert(w.wordsDict.ess_startup.instance.warningduringimporting)):(w.isViewMode=!1,g.takeOverUser(y,z).then(function(a){w.appStatus.isLoading=!1,w.otherUserStatus.isOccupied=!1,m()}))})};var C;w.helps=function(){i.getHelp({uid:a.uid,lid:a.lid}).$promise.then(function(a){for(var b=a.helpContent.paths,c=0,d=b.length;c<d;c++){var e=b[c],f=angular.element(document.querySelector(e.selector));f.length>0&&(f.addClass("help-target"),f.data("help-title",e.title),f.data("help-text",e.text),f.data("help-posx",e.pos_x),f.data("help-posy",e.pos_y))}angular.element(document.querySelectorAll(".help-target")).bind("mouseover",function(a){u(a)}),angular.element(document.querySelectorAll(".help-target")).bind("mouseleave",function(a){v(a)}),angular.element(document.querySelectorAll(".help-target")).bind("click",function(a){v(a)})})},w.logout=function(){f.terminateMyself(a.uid,a.lid),c.lang=w.globalParams.global.lang,c.islogout=!0,w.envStatus={isDoneInstance:!1,isImporting:!1,isReadyForApp:!1}}}angular.module("auriqCJPath").controller("PathsCtrl",a),a.$inject=["$scope","$q","$rootScope","$window","$cookies","pathsService","envService","$location","API","$compile","$timeout","$route"]}(),function(){"use strict";angular.module("auriqCJPath").controller("ModalCacheFilesRefreshCtrl",["$scope","$uibModalInstance","items","API","$q",function(a,b,c,d,e){function f(){d.getCacheQueue({uid:a.uid,lid:a.lid,cachedirname:a.cachedirname,contenttype:"cachefiles",oprtype:"get"}).$promise.then(function(b){a.filelist=b.files,a.isLoading=!1})}a.cachedirname=c.cachedirname,a.uid=c.uid,a.lid=c.lid,a.isLoading=!0,a.filelist=[],a.isCollapsed=!1,a.clearCacheType="withoutcj",f(),a.clearCache=function(b){a.isLoading=!0,d.getCacheQueue({uid:a.uid,lid:a.lid,cachedirname:a.cachedirname,clearcachetype:b,contenttype:"cachefiles",oprtype:"remove"}).$promise.then(function(b){a.filelist=b.files,a.isLoading=!1})},a.cancel=function(){b.dismiss("cancel")}}]).controller("ModalCacheListCtrl",["$scope","$uibModalInstance","items","API","$q",function(a,b,c,d,e){var f=angular.copy(c.params);f.uid=c.uid,f.lid=c.lid,a.editObj=angular.copy(c.obj),a.operationtype=c.type,a.columnsorder=["id","cachedirname","label","type","start_date","end_date","prev_days","sample","memo"],a.save_modify=function(){f.obj=JSON.stringify(a.editObj),d.getCacheQueue(f).$promise.then(function(a){b.close()})},a.cancel=function(){b.dismiss("cancel")}}]).controller("ModalCacheBatchCtrl",["$scope","$uibModalInstance","items","API","$q",function(a,b,c,d,e){function f(a){var b=a.value;if(""===b)a.iserror=!0,a.message="this field cannot be empty";else if(b.match(/^\d{4}([./-])\d{2}\1\d{2}$/)){var c=b.split("-"),d=c[0],e=c[1],f=c[2];d>1970&&e>=1&&e<=12&&f>=1&&f<=31?(a.iserror=!1,a.message=""):(a.iserror=!0,a.message="invalid format")}else a.iserror=!0,a.message="invalid format"}function g(a){var b=a.value;""===b?(a.iserror=!0,a.message="this field cannot be empty"):b%1==0?(a.iserror=!1,a.message=""):(a.iserror=!0,a.message="invalid format")}function h(a){a.iserror=!1,a.message=""}if(a.isLoading=!0,a.operationtype=c.type,a.editObj=c.obj||{},"add"===a.operationtype){var i=new Date,j=(i.getMonth()+1).toString(),k=i.getDate().toString();j=1===j.length?"0"+j:j,k=1===k.length?"0"+k:k;var l=[i.getFullYear(),j,k].join("-");a.addObj=[{column:"sdate",label:"date from",value:"",help:"yyyy-mm-dd as "+l,iserror:!1,formatcheck:f},{column:"edate",label:"date to",value:"",help:"yyyy-mm-dd as "+l,iserror:!1,formatcheck:f},{column:"bdays",label:"days go back",value:"",iserror:!1,formatcheck:g},{column:"sample",label:"sample size",value:"",iserror:!1,formatcheck:g},{column:"comment",label:"comment",value:"",iserror:!1,formatcheck:h}],a.isLoading=!1}else a.columnsorder=["id","sdate","edate","bdays","sample","comment"],a.isLoading=!1;a.formatcheck=function(a){a.formatcheck(a)},a.cancel=function(){b.dismiss("cancel")},a.save_new=function(){for(var c=!1,e=0,f=a.addObj.length;e<f;e++)c=!0===a.addObj[e].iserror||c;c?$window.alert("There is an error in your input."):d.getCacheQueue({uid:uid,lid:lid,type:"add",obj:JSON.stringify(a.addObj)}).$promise.then(function(a){b.close()})},a.save_modify=function(){d.getCacheQueue({uid:uid,lid:lid,type:"edit",obj:JSON.stringify(a.editObj)}).$promise.then(function(a){b.close()})}}]).controller("CachesCtrl",["$scope","$q","$rootScope","$window","$uibModal","pathsService","envService","API","$location","$route","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){function l(b){if(n.isLoading=!0,n.thead=[],n.tbody=[],n.templaterow=[],"params"in b){var c=b.params;c.uid=o,c.lid=p,h.getCacheQueue(c).$promise.then(function(b){a.cachelist=b.cachelist,n.isLoading=!1})}else n.isLoading=!1}function m(){for(var a=0,b=n.menus.length;a<b;a++)n.menus[a].class=n.menus[a].class.replace(" active","")}var n=this;n.isAuthUser=a.masterFlg,n.isLoading=!0;var o=a.uid,p=a.lid;n.menus=[{label:"Management",class:"large-menu",description:"",contenttype:"cachelist",params:{contenttype:"cachelist",oprtype:"get",is_show_deleted:!1}}],n.changeMenu=function(b,c){m(),b.class+=" active",n.selectedItem=b,l(n.selectedItem),n.selectedItem.params.oprtype="get",a.isHelpCollapse=!0},n.changeMenu(n.menus[0],0),n.syncFromS3=function(){var a=angular.copy(n.selectedItem);a.params.oprtype="syncFromS3",l(a)},n.changeIfDeletedItemsToShow=function(){var a=angular.copy(n.selectedItem);a.params.oprtype="get",l(a)},n.updateCacheListDbInfo=function(b,c){var d=b.id,e="";"isactive"===c&&(e=0==b[c]?1:0),"deleted_at"===c&&(e=b[c]?"NULL":"NOW()");var f=angular.copy(n.selectedItem.params);f.oprtype="edit";var g={id:d};g[c]=e,f.obj=JSON.stringify(g),n.isLoading=!0,h.getCacheQueue(f).$promise.then(function(b){a.cachelist=b.cachelist,n.isLoading=!1})},a.open_modify_panel=function(b,c){var d=angular.copy(n.selectedItem.params);d.oprtype="edit",a.items={type:b,obj:c,uid:o,lid:p,params:d},e.open({animation:!0,templateUrl:"cachelist"===n.selectedItem.contenttype?"views/modals/cache-list.html":"views/modals/cache-batch.html",controller:"cachelist"===n.selectedItem.contenttype?"ModalCacheListCtrl":"ModalCacheBatchCtrl",size:"lg",resolve:{items:function(){return a.items}}}).result.then(function(a){l(n.selectedItem)},function(){})},n.openCacheFilesModal=function(a){e.open({animation:!0,templateUrl:"views/modals/cache-files-list-refresh.html",controller:"ModalCacheFilesRefreshCtrl",size:"lg",resolve:{items:function(){return{uid:o,lid:p,cachedirname:a.cachedirname}}}}).result.then(function(a){},function(){})},a.remove=function(a){if("processing"===a.status)return d.alert("You cannot delete job/data on processing. Please try this later"),!1;"requested"===a.status?d.confirm("Are you sure you want to cancel this job?")&&h.getCacheQueue({uid:o,lid:p,type:"cancel",cid:a.id}).$promise.then(function(a){getCache()}):"done"===a.status&&d.confirm("Are you sure you want to remove this data?")&&h.getCacheQueue({uid:o,lid:p,type:"remove",cid:a.id,fname:a.fname}).$promise.then(function(a){getCache()})},n.logout=function(){f.terminateMyself(a.uid,a.lid),c.islogout=!0},a.switchProjects=function(b){a.isLoading=!0,f.terminateMyself(a.uid,a.lid).then(function(){i.search({uid:b}),c.uid=b,j.reload()})},k(function(){a.menu_h=angular.element(document.querySelector(".configWrapper.active")).height()})}])}(),function(){"use strict";angular.module("auriqCJPath").factory("configCommonFunction",["formatCheckFactory",function(a){var b={};return b.inputValueCheck=function(b){"DATE"===b.format?a.check_date(b):"NUMBER"===b.format?a.check_int(b):b.iserror=""!==b.value},b.inputValuesCheckAll=function(a){if(!a.userinputs)return!0;if(!a.isSelected)return!0;for(var c=0,d=a.userinputs.length;c<d;c++){var e=a.userinputs[c];if(b.inputValueCheck(e),e.iserror&&(a.isSelected=!1),e.iserror)return a.userinputok=!1,!1}return!0},b.builtConditionValueFromParts=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)"condselection"===a[d].type&&(c=a[d].userselectpartslist);for(var f=[],g=[],d=0,e=c.length;d<e;d++)if(c[d].isSelected){for(var h=c[d].condValue||"",i=0,j=c[d].userinputs.length;i<j;i++){var k=c[d].userinputs[i];h=h.replace(new RegExp(k.valname,"g"),k.value)}g.push(c[d]),f.push(h)}return{cvalue:f.join(b),cselect:g}},b.setConditionValueFromParts=function(a,c){for(var d=b.builtConditionValueFromParts(a,c),e=d.cvalue,f=d.cselect,g=0,h=a.length;g<h;g++)"condvalue"===a[g].type&&(a[g].value=e);for(var g=0,h=a.length;g<h;g++)"condselection"===a[g].type&&(a[g].value=f)},b.getCondName=function(a){for(var b=0,c=a.length;b<c;b++)if("condname"===a[b].type)return a[b].value;return""},b.changeSelectStatus=function(a,c,d){c.isSelected=!c.isSelected;var e=b.inputValuesCheckAll(c);return b.setConditionValueFromParts(a,d),""!==b.getCondName(a)&&e},b.checkFormatOfUserInput=function(a,c,d,e){if(c.isSelected){if(b.inputValueCheck(d),d.iserror)return c.isSelected=!1,b.setConditionValueFromParts(a,e),!0;b.setConditionValueFromParts(a,e);var f=b.getCondName(a);return""!==f&&!d.iserror}d.iserror||b.setConditionValueFromParts(a,e);var f=b.getCondName(a);return""!==f},b}]).controller("ModalOptionsCtrl",["$scope","$uibModalInstance","items","API","$q",function(a,b,c,d,e){function f(){for(var b=a.menuObj.params,c=-1,d=b.uid,e=b.lid,f=(b.esspara,b.pattern,[]),g=[],h=0,i=a.filterObj.length;h<i;h++){var j=!1,k=a.filterObj[h],l=k.type,m=k.value;"custnoLogin"===l&&(m=e),"custnoView"===l&&(m=d),"add"===a.operationtype&&"id"===l&&(j=!0),"add"===a.operationtype&&"essParaName"===l&&(m=a.essparam),"edit"===a.operationtype&&"id"===l&&(c=m),j||(f.push(l),g.push(m))}return{uid:d,lid:e,pattern:"options",filterSelection:JSON.stringify([{operation:"add"===a.operationtype?"insert":"update",names:f,values:g,id:c}])}}a.operationtype=c.type,a.menuObj=c.menuObj,a.filterObj=c.filterObj?angular.copy(c.filterObj.colms):angular.copy(c.template),a.suggestlist=c.suggestlist,a.isOkToSave=!1,a.essparam=c.menuObj.params?c.menuObj.params.esspara:"",a.selectSuggest=function(a,b){a.value=b},a.$watch("filterObj",function(b,c){for(var d=!1,e=0,f=b.length;e<f;e++)b[e].isEdit&&(d=!b[e].isEmptyOk&&!b[e].value||d);a.isOkToSave=!d},!0),a.cancel=function(){b.dismiss("cancel")},a.save=function(){var a=f();d.saveFilters(a).$promise.then(function(){b.close()})}}]).controller("ModalNonGroupCtrl",["$scope","$uibModalInstance","items","API","$q","configCommonFunction",function(a,b,c,d,e,f){function g(){for(var b=a.menuObj.params,c=-1,d=b.uid,e=b.lid,f=b.esspara,g=b.pattern,h=["groupName","custnoLogin","custnoView","essParaName"],i=[g,e,d,f],j=0,k=a.filterObj.length;j<k;j++){var l=!1,m=a.filterObj[j],n=m.type,o=m.value;"add"===a.operationtype&&"id"===n&&(l=!0),"add"===a.operationtype&&"condid"===n&&(o=0),"add"===a.operationtype&&"condactiveflg"===n&&(o=0),"condselection"===n&&(o=JSON.stringify(o)),"id"===n&&(c=o),l||(h.push(n),i.push(o))}return{uid:d,lid:e,type:a.menuObj.params.esspara,pattern:a.menuObj.params.pattern,filterSelection:JSON.stringify([{operation:"add"===a.operationtype?"insert":"update",names:h,values:i,id:c}])}}a.isLoading=!0;var h=" && ";c=angular.copy(c),a.operationtype=c.type,a.filterObj="add"===a.operationtype?c.template:c.filterObj.colms||{};angular.copy(c.optionparts);a.isOwner=c.isOwner,a.menuObj=c.menuObj||{},a.isLoading=!1,a.isOkToSave,a.checkIfNameIsEmpty=function(){for(var b="",c=0,d=a.filterObj.length;c<d;c++)"condname"===a.filterObj[c].type&&(b=a.filterObj[c].value,a.filterObj[c].iserror=""===b);a.isOkToSave=""!==b},a.checkFormatOfUserInput=function(b,c,d){a.isOkToSave=f.checkFormatOfUserInput(b,c,d,h)},a.changeSelectStatus=function(b,c){a.isOkToSave=f.changeSelectStatus(b,c,h)},a.cancel=function(){b.dismiss("cancel")},a.save=function(){var a=g();d.saveFilters(a).$promise.then(function(){b.close()})}}]).controller("ModalGroupCtrl",["$scope","$uibModalInstance","items","API","$q","$window","configCommonFunction",function(a,b,c,d,e,f,g){function h(){var b=Object.values(a.valueErrorStatus),c=Object.keys(a.valueErrorStatus);a.isOkToSave=-1===b.indexOf(!0)&&-1!==c.indexOf("gname")&&c.length>1}function i(){for(var b=a.menuObj.params,c=b.uid,d=b.lid,e=b.esspara,f=b.pattern,g=0,h=a.filterObjArr.length;g<h;g++){for(var i,j=["groupName","custnoLogin","custnoView","essParaName"],o=[f,d,c,e],p=0,q=a.filterObjArr[g].length;p<q;p++){var r=!1,s=a.filterObjArr[g][p],t=s.type,u=s.value;"edit"===a.operationtype&&"id"===t&&(i=u),"id"===t&&(r=!0),"edit"===a.operationtype&&"setid"===t&&(u=l),"condid"===t&&(u=g+1),"setactiveflg"===t&&(u=m),"condselection"===t&&(u=JSON.stringify(u)),"condactiveflg"===t&&("usrseg"===a.menuObj.params.esspara?"add"!==a.operationtype&&0!=m||(u=0):u=-1),"setname"===t&&(u=k),"memo"===t&&(u=a.setComment),r||(j.push(t),o.push(u))}n.push({operation:"edit"===a.operationtype&&"new"!==i?"update":"insert",names:j,values:o,id:i})}return{uid:c,lid:d,type:a.menuObj.params.esspara,pattern:a.menuObj.params.pattern,filterSelection:JSON.stringify(n)}}a.isLoading=!0;var j=" ";c=angular.copy(c),a.operationtype=c.type;angular.copy(c.optionparts);a.filterObjArr=[],a.isOwner=c.isOwner,a.setName="add"===a.operationtype?null:c.filterObj.setname,a.setComment=c.filterObj?c.filterObj.memo:"";var k=a.setName,l="add"===a.operationtype?null:c.filterObj.setid,m="add"===a.operationtype?0:c.filterObj.isActive;a.menuObj=c.menuObj||{},a.isOkToSave=!1,a.valueErrorStatus={},a.setNameIsError=!1;var n=[];if(a.addCondition=function(){var b=angular.copy(c.template);a.filterObjArr.push(b),a.valueErrorStatus[a.filterObjArr.length-1]=!0,h()},"add"===a.operationtype)a.addCondition(),a.isLoading=!1,m=0;else{a.isLoading=!0;var o=a.menuObj.params;l=c.filterObj.setid,m=c.filterObj.isActive,o.setid=l;var p=[];d.getFilters(o).$promise.then(function(b){var c=b.data.tbody;a.valueErrorStatus={gname:!1};for(var d=0,e=c.length;d<e;d++)p.push(c[d].colms),a.valueErrorStatus[d]=!1;a.filterObjArr=p,a.isLoading=!1})}a.checkFormatOfUserInput=function(b,c,d){a.isOkToSave=g.checkFormatOfUserInput(b,c,d,j)},a.changeSelectStatus=function(b,c){a.isOkToSave=g.changeSelectStatus(b,c,j)},a.removeCondition=function(b,c){for(var d=!0,e=0,g=b.length;e<g;e++)-1!==["condname","condvalue"].indexOf(b[e].type)&&(d=!b[e].value&&d);var i=!1;if(d?i=!0:f.confirm('Are you sure to remove this condition set? (it will not be actually removed until you press "save" button.)')&&(i=!0),i){var j=a.filterObjArr.splice(c,1),k=function(){for(var a=0,b=j[0].length;a<b;a++)if("id"==j[0][a].type)return j[0][a].value}();n.push({operation:"delete",ids:[k]}),delete a.valueErrorStatus[c],h()}},a.selectSuggest=function(b,c,d){c.value=d,a.valueErrorStatus[b]=!1,h()},a.checkValue=function(b,c,d){a.valueErrorStatus[c]=!b,h(),d?d.isError=!b:(k=b,a.setNameIsError=!b)},a.conditionIsChanged=function(){h()},a.commentIsChanged=function(b){a.setComment=b,h()},a.cancel=function(){b.dismiss("cancel")},a.save=function(){a.isLoading=!0;var c=i();n=[],d.saveFilters(c).$promise.then(function(){b.close()})}}]).controller("ConfigsCtrl",["$scope","$q","$rootScope","$window","$uibModal","pathsService","envService","API","$location","$route","$timeout",function(a,b,c,d,e,f,g,h,i,j,k){function l(){for(var a=0,b=n.menus.length;a<b;a++)n.menus[a].class=n.menus[a].class.replace(" active","")}function m(a){if(n.isLoading=!0,n.thead=[],n.tbody=[],n.templaterow=[],"params"in a){var b=a.params;b.uid=o,b.lid=p,h.getFilters(b).$promise.then(function(a){n.tbody=a.data.tbody,n.thead=a.data.thead,n.addpattern=a.data.addpattern,n.templaterow=a.data.templaterow,n.headerlabels=a.data.dblabels||{},q=a.data.suggest||[],r=a.data.parts||[],n.isLoading=!1})}else n.isLoading=!1}var n=this,o=a.uid,p=a.lid;n.isAuthUser=a.masterFlg,n.isLoading=!0;var q=[],r=[];n.menus=[{label:"Configuration",class:"large-menu",description:"Configuration setting for overall report application."},{label:"Conversion",class:"sub-menu",description:"Conversion(CV) condition setting. Multipart CV conditions are joined as a logical AND",params:{type:"radio",gettype:"detail",pattern:"global",esspara:"cvcond",setid:-1,popupmode:""}},{label:"User Segment",class:"sub-menu",params:{type:"radio",gettype:"detail",pattern:"global",esspara:"usrseg",setid:-1,popupmode:""}},{label:"Touchpoint",description:"",class:"sub-menu",params:{gettype:"detail",type:"radio",pattern:"cvpath",esspara:"pathtpdef",setid:-1,popupmode:""}},{label:"Definition",class:"large-menu",description:"In this section, can define conversion goal and user segment conditions that are used in your aconfigurations."},{label:"Conversion",class:"sub-menu",params:{gettype:"options",is_show_deleted:!1,esspara:"cvcond"}},{label:"User Segment",class:"sub-menu",params:{gettype:"options",is_show_deleted:!1,esspara:"usrseg"}}],n.changeMenu=function(b,c){l(),b.class+=" active",n.selectedItem=b,m(n.selectedItem),a.isHelpCollapse=!0},n.changeMenu(n.menus[0],0),k(function(){a.menu_h=angular.element(document.querySelector(".configWrapper.active")).height()}),n.modal=function(b,c){a.items={type:b,filterObj:c,template:n.templaterow,menuObj:n.selectedItem,suggestlist:q,optionparts:r,isOwner:n.isAuthUser};var d=-1!==["usrseg","pathtpdef"].indexOf(n.selectedItem.params.esspara),f="options"===n.selectedItem.params.gettype;e.open({animation:!0,templateUrl:f?"views/modals/config-filter-options.html":d?"views/modals/config-filter-group.html":"views/modals/config-filter-nongroup.html",controller:f?"ModalOptionsCtrl":d?"ModalGroupCtrl":"ModalNonGroupCtrl",size:"lg",resolve:{items:function(){return a.items}}}).result.then(function(a){m(n.selectedItem)},function(){})},a.optionssearchkeyword="",a.searchFilter=function(a){var b=document.getElementById("optionssearchkeyword").value||"",c=a.colms;if(""===b)return!0;for(var d=b.split(" "),e={},f=0,g=c.length;f<g;f++)for(var h=0,i=d.length;h<i;h++)-1!==c[f].value.indexOf(d[h])&&(e[d[h]]=!0);return d.length===Object.keys(e).length},n.remove=function(a){if(d.confirm("Are you sure to remove this ?")){var b={};b=a.setname?{uid:o,lid:p,type:n.selectedItem.params.esspara,
pattern:n.selectedItem.params.pattern||n.selectedItem.params.gettype,filterSelection:JSON.stringify([{operation:"delete",setid:a.setid}])}:{uid:o,lid:p,type:n.selectedItem.params.esspara,pattern:n.selectedItem.params.pattern||n.selectedItem.params.gettype,filterSelection:JSON.stringify([{operation:"delete",ids:[a.colms[0].value]}])},h.saveFilters(b).$promise.then(function(){m(n.selectedItem)})}},n.logout=function(){f.terminateMyself(a.uid,a.lid),c.islogout=!0,n.envStatus={isDoneInstance:!1,isImporting:!1,isReadyForApp:!1}},a.switchProjects=function(b){a.isLoading=!0,f.terminateMyself(a.uid,a.lid).then(function(){i.search({uid:b}),c.uid=b,j.reload()})}}])}(),function(){"use strict";angular.module("auriqCJPath").controller("ModalDbCtrl",["$scope","$uibModalInstance","items","API","$q",function(a,b,c,d,e){function f(){var b=-1,c=i.uid,d=i.lid,e=[],f=[];for(var g in a.dbRowObj){var h=!1,k=g,l=a.dbRowObj[g];"add"===a.operationtype&&"id"===k&&(h=!0),"id"===k&&(b=l),h||(e.push(k),f.push(l))}return{uid:c,lid:d,oprtype:"update",dbObj:JSON.stringify({tblname:j,operation:"add"===a.operationtype?"insert":"update",names:e,values:f,id:b})}}a.isLoading=!0,c=angular.copy(c),a.operationtype=c.type;var g="add"===a.operationtype?{}:c.rowObj,h=c.fields,i=c.basics,j=c.table;if("add"===a.operationtype)for(var k=0,l=h.length;k<l;k++)g[h[k]]="";a.dbRowObj=g,a.fieldList=h,a.menuObj=c.menuObj||{},a.isLoading=!1,a.isOkToSave=!0,a.selectSuggest=function(a,b){a.value=b},a.cancel=function(){b.dismiss("cancel")},a.save=function(){var c=f();d.getDbs(c).$promise.then(function(c){a.isError=c.iserror,a.isError||b.close()})}}]).controller("DevtoolsCtrl",["$scope","$q","$rootScope","$window","$uibModal","pathsService","envService","API","API_BASE","urlsFactory","$location","$route","$timeout",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){p.list=[],p.searchtext="";for(var a=0,b=p.menus.length;a<b;a++)p.menus[a].class=p.menus[a].class.replace(" active","")}function o(a){if(p.isLoading=!0,p.thead=[],p.tbody=[],p.templaterow=[],"params"in a){var b=a.params;"log"===a.contenttype?(b.uid=q,b.lid=r,b.gettype="data",h.getLogs(b).$promise.then(function(a){p.log=a.log,p.tstamp=p.convertTimeSecToString(a.timestamp),"list"in a&&(p.list=a.list),"list"in a&&(p.selectDeopdown=a.list[0]||""),p.isLoading=!1})):"cachedvars"===a.contenttype?(b.uid=q,b.lid=r,b.gettype="data",h.getLogs(b).$promise.then(function(a){p.cvlist=a.list,p.isLoading=!1})):"db"===a.contenttype?(b.uid=q,b.lid=r,b.oprtype="get",h.getDbs(b).$promise.then(function(a){p.tbody=a.tbody,p.thead=a.thead,"tablelist"in a&&(p.tablelist=a.tablelist),"tablelist"in a&&(p.selectDeopdown=p.tablelist[0]||""),p.isLoading=!1})):"dbbackups"===a.contenttype&&(b.uid=q,b.lid=r,b.oprtype="dbbackups",h.getDbs(b).$promise.then(function(a){p.dbbackuplist=a.list,p.isLoading=!1}))}else p.isLoading=!1}var p=this,q=a.uid,r=a.lid;p.isAuthUser=a.masterFlg,p.isLoading=!0,p.searchtext="",p.menus=[{label:"Log Viewer",class:"large-menu",description:'You can see task.log and udbd logs.<br>- task.log : that is created by ess command when it catched an error.<br>- udbd log that is created when `ess udbd` family is executed<br><br>If you click the trash icon <i class="glyphicon glyphicon-trash"></i>, the log will be deleted. The application side will not take any backup or copy of it.'},{label:"task.log",class:"sub-menu",contenttype:"log",params:{type:"tasklog"}},{label:"udbd log",class:"sub-menu",contenttype:"log",params:{type:"udbdlist"}},{label:"Cached Vars",class:"large-menu",contenttype:"cachedvars",description:"These are the variables that will be passed to bash script that executes essentia. If those variables are wrong or different from what users specify via GUI, the report users are seeing will be also wrong and there should be a bug in this application. <br><br>This is mostly for debugging. Let system developers know if you find a bug!",params:{type:"cachedvarlist"}},{label:"MySQL",class:"large-menu",description:'In "MySQL Viewer" section, you can see data stored in local database. You can also modify, add, and remove data from database.<br>The application does not check format of your input or if it is expected value or not. This is very <b>POWERFUL</b>. Do not run any operation unless you are 100% sure about it. With great power comes great responsibility.<br><br>In "Backups" section, you can take backup of local database (the backup file will be pushed to s3 bucket) by clicking <i class="glyphicon glyphicon-plus"></i> button. You can also restore datatabase with a backup file in s3 bucket by clicking <i class="glyphicon glyphicon-share-alt"></i> icon.'},{label:"MySQL Viewer",class:"sub-menu",contenttype:"db",params:{type:"all"}},{label:"Backups",description:"",class:"sub-menu",contenttype:"dbbackups",params:{type:"list"}}],p.convertTimeSecToString=function(a){return"-"===a?a:new Date(1e3*a).toISOString()},p.changeMenu=function(a,b){n(),a.class+=" active",p.selectedItem=a,o(p.selectedItem)},p.changeMenu(p.menus[0],0),p.changeDropDown=function(a){p.selectDeopdown=a;var b=angular.copy(p.selectedItem);"log"===p.selectedItem.contenttype&&"tasklog"!==b.params.type&&(b.params.type="udbdlog",b.params.udbdlogname=a),"db"===p.selectedItem.contenttype&&(p.searchtext="",b.params.type="bytablename",b.params.tblname=a),o(b)},p.log_dl=function(){var a=angular.copy(p.selectedItem.params);a.uid=q,a.lid=r,a.gettype="dl",location.href=i+"/"+j.getLogs+"?"+$.param(a)},p.log_trash=function(){if(d.confirm("Are you sure you want to remove log?")){p.isLoading=!0;var a=angular.copy(p.selectedItem.params);"tasklog"!==a.type&&(a.type="udbdlog",a.udbdlogname=p.selectDeopdown),a.uid=q,a.lid=r,a.gettype="rm",h.getLogs(a).$promise.then(function(a){p.isLoading=!1,o(p.selectedItem)})}},p.open_dbmodal=function(b,c){a.items={type:b,rowObj:c,fields:angular.copy(p.thead),table:p.selectDeopdown,basics:{uid:q,lid:r}},e.open({animation:!0,templateUrl:"views/modals/devtool-db.html",controller:"ModalDbCtrl",size:"lg",resolve:{items:function(){return a.items}}}).result.then(function(a){p.changeDropDown(p.selectDeopdown)},function(){})},p.dbremove=function(b){if(d.confirm("Are you sure you want to remove this row?")){var c={uid:q,lid:r,oprtype:"delete",tblname:p.selectDeopdown,id:b.id||b.id};h.getDbs(c).$promise.then(function(b){a.isError=b.iserror,p.changeDropDown(p.selectDeopdown)})}},p.dbrestore=function(a){d.confirm("Are you sure you want to restore database with this backup file?")&&(p.isLoading=!0,h.getDbs({uid:q,lid:r,oprtype:"dbbackups",type:"restore",fname:a}).$promise.then(function(a){p.dbbackuplist=a.list,p.isLoading=!1}))},p.dbtakebackup=function(){p.isLoading=!0,h.getDbs({uid:q,lid:r,oprtype:"dbbackups",type:"take"}).$promise.then(function(a){p.dbbackuplist=a.list,p.isLoading=!1})},p.dbdownload=function(a){var b={uid:q,lid:r,oprtype:"dbbackups",type:"download",fname:a};location.href=i+"/"+j.getDbs+"?"+$.param(b)},p.logout=function(){f.terminateMyself(a.uid,a.lid),c.islogout=!0,p.envStatus={isDoneInstance:!1,isImporting:!1,isReadyForApp:!1}},a.switchProjects=function(b){a.isLoading=!0,f.terminateMyself(a.uid,a.lid).then(function(){k.search({uid:b}),c.uid=b,l.reload()})},m(function(){a.menu_h=angular.element(document.querySelector(".configWrapper.active")).height()})}])}(),function(){"use strict";function a(a,c,d,e){function f(f){function g(){f.isSidebarOpened=!f.isSidebarOpened,d.bodyClass=f.isSidebarOpened?"no-scroll":""}function h(c){if(c.isActive)return void(c.isOpen=!c.isOpen);angular.forEach(b,function(a){a.isActive=!1,a.isOpen=!1}),c.isActive=!0,c.isOpen=!0,a.path(c.path),e(function(){f.isSidebarOpened=!0,g()},400)}f.isAuthUser=d.masterFlg,f.groups=b,f.toggleSidebar=g,f.activateItem=h,f.paths=c.contentsList,f.isSidebarOpened=!1,f.showSidebarCharts=!1;var i=a.path();angular.forEach(b,function(a){var b=a.path===i;a.isActive=b,a.isOpen=b});var j=a.path().replace("/","");"landing"===j&&(j="paths"),h(b[j])}return{restrict:"A",templateUrl:"views/directives/templ-sidebar.html",link:f}}angular.module("auriqCJPath").directive("sidebar",a),a.$inject=["$location","pathsService","$rootScope","$timeout"];var b={paths:{name:"paths",isActive:!1,isOpen:!1,path:"/paths"},caches:{name:"caches",isActive:!1,isOpen:!1,path:"/caches"},configs:{name:"configs",isActive:!1,isOpen:!1,path:"/configs"}}}(),angular.module("auriqCJPath").filter("ellipsedString",["$timeout",function(a){function b(a,b){for(var c,d=document.getElementById("ruler-"+b);c=d.lastChild;)d.removeChild(c);var e=d.appendChild(document.createTextNode(a)),f=d.offsetWidth;return d.removeChild(e),f}function c(a,c,d){if(0===c)return a;for(var e=82,f=c-e,g="",h=a.length,i=0;i<h;i++){g+=a[i];var j=b(g,d);if((j=j<6*(i+1)?6*(i+1):j)>f)return g.slice(0,-1)+"..."}return a}return function(a,b){if(void 0===a)return!1;var d=document.getElementById(b),e=d.offsetWidth;return e=e<200?200:e,c(a,e,b)}}]).directive("globalOptionsUserseg",["colorsFactory","$timeout","$filter","urlsFactory","$http","$window",function(a,b,c,d,e,f){return{restrict:"EA",require:"^globalOptions",templateUrl:"views/directives/templ-global-options-filters.html",scope:{globalparams:"=",settingobj:"=",ischanged:"=",isviewmode:"="},link:function(a,b,c,d){function e(){if(void 0===a.globalparams.filterdiff&&(a.globalparams.filterdiff={}),void 0===a.globalparams.filterdiff.usrseg&&(a.globalparams.filterdiff.usrseg=[]),a.ischanged){var b=[];a.settingobj.curractive&&b.push({operation:"update",names:["condActiveFlg"],values:[0],id:a.settingobj.curractive.activeCondId}),b.push({operation:"update",names:["condActiveFlg"],values:[1],id:a.settingobj.currselected.activeCondId}),a.settingobj.curractive&&b.push({operation:"update",names:["setActiveFlg"],values:[0],id:a.settingobj.curractive.ids.join(",")}),a.settingobj.currselected.ids&&b.push({operation:"update",names:["setActiveFlg"],values:[1],id:a.settingobj.currselected.ids.join(",")}),a.globalparams.filterdiff.usrseg=angular.copy(b)}else a.globalparams.filterdiff.usrseg=[]}a.$watchCollection(function(){return{settingobj:a.settingobj}},function(){void 0!==a.settingobj&&(a.list=a.settingobj.list,a.settingobj.curractive?a.settingobj.curractive.activeCondName?a.selectedlbl=a.settingobj.curractive.activeCondName:(a.settingobj.currselected=angular.merge({},a.settingobj.curractive,a.settingobj.curractive.list[0]),a.settingobj.currselected.activeCondId=a.settingobj.currselected.id,a.selectedlbl=a.settingobj.currselected.condName,delete a.settingobj.curractive,a.ischanged=!0,e()):(a.settingobj.currselected=angular.merge({},a.settingobj.list[0],a.settingobj.list[0].list[0]),a.settingobj.currselected.activeCondId=a.settingobj.currselected.id,a.selectedlbl=a.settingobj.currselected.condName,a.ischanged=!0,e()))}),a.changeItemInList=function(c,d,f){b.find(".dropdown-2ndlayer").find("li").removeClass("user-select"),angular.element(f.target).parent().addClass("user-select"),a.settingobj.currselected=angular.copy(c),a.settingobj.currselected.activeCondId=d.id,a.settingobj.currselected.activeCondName=d.condName,a.selectedlbl=d.condName,a.ischanged=!a.settingobj.curractive||a.settingobj.currselected.activeCondId!==a.settingobj.curractive.activeCondId,e()}},controller:["$scope","$element",function(a,b){a.icon="fa fa-users",a.layerpattern="double",a.btn_id="dropdown_usersegment_bttn"}]}}]).directive("globalOptionsCvTag",["colorsFactory","$timeout","$filter","urlsFactory","$http","$window",function(a,b,c,d,e,f){return{restrict:"EA",require:"^globalOptions",templateUrl:"views/directives/templ-global-options-filters.html",scope:{globalparams:"=",settingobj:"=",ischanged:"=",isviewmode:"="},link:function(a,b,c,d){function e(){if(void 0===a.globalparams.filterdiff&&(a.globalparams.filterdiff={}),void 0===a.globalparams.filterdiff.cvcond&&(a.globalparams.filterdiff.cvcond=[]),a.ischanged){var b=[];a.settingobj.curractive&&b.push({operation:"update",names:["condActiveFlg"],values:[0],id:a.settingobj.curractive.id}),b.push({operation:"update",names:["condActiveFlg"],values:[1],id:a.settingobj.currselected.id}),a.globalparams.filterdiff.cvcond=angular.copy(b)}else a.globalparams.filterdiff.cvcond=[]}a.$watchCollection(function(){return{settingobj:a.settingobj}},function(){void 0!==a.settingobj&&(a.list=a.settingobj.list,void 0===a.settingobj.curractive?(a.selectedlbl=a.list[0].condName,a.settingobj.currselected=angular.copy(a.list[0]),a.ischanged=!0,e()):a.selectedlbl=a.settingobj.curractive.condName)}),a.changeItemInList=function(c,d){b.find(".dropdown-menu").find("li").removeClass("user-select"),angular.element(d.target).parent().addClass("user-select"),a.settingobj.currselected=angular.copy(c),a.selectedlbl=c.condName,a.ischanged=!a.settingobj.curractive||a.settingobj.currselected.id!==a.settingobj.curractive.id,e()}},controller:["$scope","$element",function(a,b){a.icon="fa fa-dot-circle-o",a.layerpattern="single",a.btn_id="dropdown_cv_bttn"}]}}]).directive("cachePicker",["colorsFactory","$timeout","$filter","urlsFactory","$http","$window",function(a,b,c,d,e,f){return{restrict:"EA",templateUrl:"views/directives/templ-cache-picker.html",scope:{cachelist:"=",optlang:"=",ischanged:"=",globalparams:"=",isviewmode:"="},link:function(a,b){function c(){for(var b=0,c=a.cachelist.length;b<c;b++)if(a.cachelist[b].is_imported)return a.changeCache(a.cachelist[b]),!1;a.changeCache(a.cachelist[0])}a.$watchCollection(function(){return{globalparams:a.globalparams}},function(){void 0!==a.cachelist&&void 0!==a.globalparams&&a.cachelist.length>0&&(a.optglblcurr=a.globalparams.currentimported,c())}),a.changeCache=function(b,c){a.ischanged=!b.is_imported,a.userselect_cachelabel=b.label||"";for(var d in b)a.globalparams.userchoice[d]=b[d]||a.globalparams.userchoice[d]||"";for(var e=0,f=a.cachelist.length;e<f;e++)a.cachelist[e].is_selected=!1;b.is_selected=!0,a.$parent.$broadcast("globalParmaUpadate",a.globalparams)},a.searchFilter=function(a){var c=b.find("#cachesearchbykeywords").find("input").val()||"";if(""===c)return!0;for(var d=c.split(" "),e=!0,f=0,g=d.length;f<g;f++)-1===a.label.indexOf(d[f])&&(e=!1);return e}},controller:["$scope","$element",function(a,b){a.btn_id="dropdown_cache_bttn"}]}}]).directive("globalOptions",["colorsFactory","$timeout","$filter","urlsFactory","$http","API","$rootScope","$window",function(a,b,c,d,e,f,g,h){return{restrict:"EA",templateUrl:"views/directives/templ-global-options.html",scope:{globalparams:"=",isparamavailable:"=",isviewmode:"=",words:"=",isglobalselectchanged:"="},link:function(a,b){function c(){a.uid=a.globalparams.uid,a.lid=a.globalparams.lid,a.cachelist=a.globalparams.cachelist,a.amIChanged=a.isglobalselectchanged,f.getFilters({uid:a.uid,lid:a.lid,gettype:"userconfigall"}).$promise.then(function(b){a.isLoading=!1,a.usersetting=angular.copy(b.data)})}a.isLoading=!0,a.$watchCollection(function(){return{globalparams:a.globalparams}},function(){void 0!==a.globalparams&&(a.usersegGroupChange=[],c())}),a.$on("globalParmaUpadate",function(b,c){a.globalparams=c})},controller:["$scope","$element",function(a,b){a.uid,a.lid,a.set_crnt={},a.set_slct={},a.usersegGroupChange=[],a.amIChanged={},a.isChanged=!1}]}}]),angular.module("auriqCJPath").directive("fullscreenBtn",["$window","$timeout",function(a,b){function c(c,d){function e(){var a,d,e;c.isfullscreen=i.goFull,i.goFull?(a=h.position().top,d=h.position().left,h.outerWidth(),h.outerHeight(),i.$placeholderDiv.addClass(h.attr("class")),h.addClass("pre-fullscreen fullscreen show-topbar"),i.$placeholderDiv.insertAfter(h),e={left:d,top:a},h.data("original-style",e),h.css(e),b(function(){g.addClass("no-scroll"),h.animate({top:0,left:-20},300,function(){i.goFull=!1,h.addClass("fixed"),h.addClass("no-border-radius"),f.trigger("resize")})},5),void 0!==i.$parent.initChartToFitScreen&&i.$parent.initChartToFitScreen(!0)):(g.removeClass("no-scroll"),h.removeClass("no-border-radius show-topbar"),h.animate(h.data("original-style"),300,function(){i.$placeholderDiv.remove(),h.removeClass("fixed "),h.removeClass("fullscreen"),h.removeClass("pre-fullscreen"),i.goFull=!0,f.trigger("resize")}),void 0!==i.$parent.initChartToFitScreen&&i.$parent.initChartToFitScreen(!1))}var f=(angular.element(a),$(window)),g=$("body"),h=angular.element(document.querySelector("#widget-"+c.widgetid)),i=h.scope();i.goFull=!0,i.$placeholderDiv=$("<div></div>",{class:"widget-placeholder"}),d.bind("click",function(){e()})}return{link:c,scope:{widgetid:"=",isfullscreen:"="},restrict:"EA"}}]),angular.module("auriqCJPath").directive("aqChart",["colorsFactory","$timeout","$filter","urlsFactory","$http","API","API_BASE","$rootScope","$window",function(a,b,c,d,e,f,g,h,i){return{restrict:"EA",templateUrl:"views/directives/templ-aq-chart.html",scope:{data:"=",charttype:"=",options:"=?",colors:"=?",yaxistitle:"=?",xaxistitle:"=?",yaxislabels:"=?",xaxislabels:"=?",isshowlegendflg:"=?",api:"=?"},link:function(b,c){function d(){if(b.isLoaded=!1,b.origData=[],c.find("svg").length>0)for(var a=c.find("svg"),d=0,g=a.length;d<g;d++)a[d].innerHTML="";var h=e(b.data),i=f(b.charttype,b.options);b.isshowlegendflg&&(b.origData=h.original);for(var j=b.data.slice(0),d=0,g=j.length;d<g;d++)"key"in j[d]&&(j[d].timestamp=new Date);b.chart_options=i,b.chart_data=j,b.isLoaded=!0,b.isrunning=!1}function e(a){for(var b=a.slice(0),c={},d=0,e=b.length;d<e;d++){var f=b[d].label||b[d].key;b[d].color="Other"===f?"#d5dde0":h[d],b[d].isVisible=!0,b[d].key=f,c[f]="Other"===f?"#d5dde0":h[d]}return{original:b.slice(0),colordict:$.extend(!0,{},c)}}function f(a,d){var e=c.parent().height(),f=c.parent().width(),i=100,j=200;e=e<i?i:e,f=f<j?j:f,e-=50;var k={};if(k={chart:{type:a,height:e,width:f,margin:{left:20},focusEnable:!1,showControls:!0,showLegend:!1,showLabels:!0,tooltips:!0,color:h,labelSunbeamLayout:!1}},"pieChart"===a&&(k.chart.x=function(a){return null!==a?a.label:""},k.chart.y=function(a){return null!==a?a.value:0}),"lineChart"!==a&&"linePlusBarChart"!==a||(k.chart.clipVoronoi=!1,k.chart.interpolate="linear",k.chart.transitionDuration=300,k.chart.useInteractiveGuideline=!0,k.chart.rotateLabels=-60,k.chart.reduceXTicks=!1,k.chart.x=function(a){return null!==a&&void 0!==a?void 0!==a.x?a.x:a[0]:0},k.chart.y=function(a){return null!==a&&void 0!==a?void 0!==a.y?a.y:a[1]:0},"lineChart"===a&&(k.chart.type="lineWithFocusChart",k.chart.margin={top:10,left:90},k.chart.yAxis={tickFormat:function(a,b){return-1!==a.toString().indexOf(".",0)?g(a):d3.format(",f")(a)}},k.chart.forceY=[0]),"linePlusBarChart"===a&&(k.chart.margin={top:10,left:90,right:90},k.chart.stacked=!0,k.chart.y1Axis={tickFormat:function(a,b){return-1!==a.toString().indexOf(".",0)?g(a):d3.format(",f")(a)}},k.chart.y2Axis={tickFormat:function(a,b){return-1!==a.toString().indexOf(".",0)?g(a):d3.format(",f")(a)}},k.chart.lines={forceY:[0]},k.chart.bars={forceY:[0]})),void 0!==d)for(var l in d)if(angular.isObject(d[l]))for(var m in d[l])k.chart[l]=void 0===k.chart[l]?{}:k.chart[l],k.chart[l][m]=d[l][m];else k.chart[l]=d[l];return void 0!==b.xaxislabels&&b.xaxislabels.length>0&&("xAxis"in k.chart||(k.chart.xAxis={}),k.chart.xAxis.tickFormat=function(a,c){return b.xaxislabels[a]},"x2Axis"in k.chart||(k.chart.x2Axis={}),k.chart.x2Axis.tickFormat=function(a,c){return b.xaxislabels[a]}),void 0!==b.xaxistitle&&b.xaxistitle.length>0&&("xAxis"in k.chart||(k.chart.xAxis={}),k.chart.xAxis.axisLabel=b.xaxistitle,"x2Axis"in k.chart||(k.chart.x2Axis={}),k.chart.x2Axis.axisLabel=b.xaxistitle),void 0!==b.yaxistitle&&b.yaxistitle.length>0&&(angular.isArray(b.yaxistitle)?("y1Axis"in k.chart||(k.chart.y1Axis={}),"y2Axis"in k.chart||(k.chart.y2Axis={}),k.chart.y1Axis.axisLabel=b.yaxistitle[0],k.chart.y2Axis.axisLabel=b.yaxistitle[1]):("yAxis"in k.chart||(k.chart.yAxis={}),k.chart.yAxis.axisLabel=b.yaxistitle)),k.chart.xAxis&&delete k.chart.xAxis.axisLabel,k}function g(a){return(Math.round(100*a*10)/10).toString()+"%"}var h=a.getAll();b.$watchCollection(function(){return{data:b.data}},function(){void 0!==b.data&&b.data.length>0&&(h=void 0!==b.colors&&b.colors.length>0?b.colors:a.getAll(),d())}),c.find("svg").remove()},controller:["$scope","$element",function(a,c){a.isLoaded=!1,a.rebuildGraph=function(f){if(a.isLoaded&&e(f)){a.isLoaded=!1;var g=c.find("svg > *");g.remove(),b(function(){d(f),$(g).ready(function(){a.isLoaded=!0})},0)}};var d=function(b){a.isDrawDone=!1;var c=[];a.chart_data=[],b.isVisible=!b.isVisible;for(var d=0,e=a.origData.length;d<e;d++){var f=a.origData[d];f.isVisible?c.push(a.origData[d]):f.isVisible=!1}a.chart_data=c},e=function(b){var c=!0;if(b.isVisible){for(var d=0,e=0,f=a.origData.length;e<f;e++){a.origData[e].isVisible&&d++}c=d>1}return c}}]}}]),angular.module("auriqCJPath").directive("aqTable",["colorsFactory","$timeout","$filter","urlsFactory","$http","API","API_BASE","$rootScope","$window",function(a,b,c,d,e,f,g,h,i){return{restrict:"EA",templateUrl:"views/directives/templ-aq-table.html",scope:{data:"=",height:"=?",width:"=?",ctype:"=?",header:"=?",lang:"=?"},link:function(b,c){var d=a.getAll();d[0];b.$watchCollection(function(){return{data:b.data}},function(){var a=void 0!==b.data?b.data.tbody||[]:[];void 0!==b.lang&&b.lang;if(a.length>0&&(void 0!==b.height||void 0!==b.width)){var c={},d={};void 0!==b.height&&(c.height=b.height,d.height=(parseFloat(b.height.replace("px",""))-50).toString()+"px"),void 0!==b.width&&(c.width=b.width),b.ftablestyle=d,b.wrapperstyle=c}})},controller:["$scope","$element",function(a,b){a.isLoaded=!1}]}}]),angular.module("auriqCJPath").directive("pathSummaryWrapper",["colorsFactory","$timeout","$filter","urlsFactory","$http","API","API_BASE","$rootScope","$window",function(a,b,c,d,e,f,g,h,i){return{restrict:"EA",templateUrl:"views/directives/templ-path-summary-wrapper.html",scope:{isapploaded:"=",optglbl:"=",optcont:"=",optpath:"=",isessready:"=",masterflg:"=",filterupdatecnt:"=",isviewmode:"="},link:function(a,c){function d(){b(function(){a.cwidth=c.prop("offsetWidth")})}var e=542;a.$watchCollection(function(){return{optglbl:a.optglbl,isessready:a.isessready}},function(){a.optglbl&&a.isessready&&a.optcont.isVisible&&(a.optcont.isVisible?(a.isactive=!0,b(function(){var b=angular.element(c)[0].getBoundingClientRect();e=e||b.height,a.cheight=e,a.cwidth=b.width},1e3)):a.isactive=!1)});var f;angular.element(i).bind("resize",function(){clearTimeout(f),f=setTimeout(d,500)}),a.$watchCollection("optcont.isfullscreen",function(){a.fullscreenFlg=a.optcont.isfullscreen,void 0!==a.fullscreenFlg&&b(function(){a.isactive=!0,a.cheight=a.fullscreenFlg?c.prop("offsetHeight")-150:e,a.cwidth=c.prop("offsetWidth")},1e3)})},controller:["$scope","$element",function(a,b){a.isactive=!1}]}}]),angular.module("auriqCJPath").directive("pathSummary",["colorsFactory","funcCommonFactory","$timeout","$filter","urlsFactory","$http","API","API_BASE","$rootScope","$window","$cookies",function(a,b,c,d,e,f,g,h,i,j,k){return{restrict:"EA",templateUrl:"views/directives/templ-path-summary.html",scope:{isapploaded:"=",optglbl:"=",optcont:"=",isactive:"=",ctype:"=",cheight:"=",cwidth:"=",masterflg:"=",filterupdatecnt:"=",isviewmode:"="},link:function(a,d){function f(){i().then(function(b){var d=parseInt(k.get("gsindex_"+a.ctype))||0;if(a.optpath=function(){for(var a=0,c=b.contents.data.length;a<c;a++)if("path_global_summary"===b.contents.data[a].content_name)return angular.copy(b.contents.data[a].contents)}(),"eachpathpopup"===a.ctype){a.optpath.shift();var e={contentType:"distToCV",templateType:"table",title:"Distance to CV"};a.optpath.unshift(e)}a.selectedIndex=d,c(function(){a.tabChange(d,!0)},0)})}function i(){return g.getOptions({uid:a.optglbl.uid,lid:a.optglbl.lid,opttype:""==a.ctype?"global":a.ctype}).$promise}function j(b){for(var c=a.optpath[b].options||[],d="sumopt_"+a.ctype+a.tabSelection+"_",e=0,f=c.length;e<f;e++){var g=d+e;if(c[e].varname=g,"select"===c[e].type){var h=c[e].defaultindex?c[e].defaultindex:0,i=k.get(g)||h;if(c[e].selected=c[e].list?c[e].list[i]:"",c[e].selectedidx=i,void 0!==c[e].selected.children){var j=c[e].selected.children.defaultindex?c[e].selected.children.defaultindex:0,m=g+"_chld",n=k.get(m)||j;c[e].selected.children.varname=m,c[e].selected.children.selected=c[e].selected.children.list[n]||"",c[e].selected.children.selectedidx=n,c[e].selected.children.applied=c[e].selected.children.selected}c[e].applied=$.extend(!0,{},c[e].selected)}else if("number"===c[e].type){var o=c[e].default?c[e].default:"";k.get(g);c[e].applied=c[e].default?c[e].default:"",c[e].selected=c[e].default?c[e].default:""}}l(c),a.options=c,a.contentType=a.optpath[b].contentType,a.currentTitle=a.optpath[b].title,a.templateType=a.optpath[b].templateType,a.chartType=a.optpath[b].chartType||""}function l(a){for(var b=0,c=a.length;b<c;b++)if("select"===a[b].type){var d=void 0!==a[b].disabled&&void 0!==a[b].disabled.target;if(d){for(var e=0;e<c;e++)if(a[e].name===a[b].disabled.target){var f=-1!==$.inArray(a[e].selected.value,a[b].disabled.list);a[b].disabled.status=f,f&&(a[b].selected=a[b].list[a[b].disabled.selectidx])}}else a[b].disabled={status:!1}}}function m(c){b.checkIfYouAreHijacked(a.optglbl.uid,a.optglbl.lid).then(function(b){if(!b){if(a.origData=[],a.summary=[],a.message="",a.chart_colors=[],a.isshowlegendflg=!0,d.find("svg").length>0)for(var e=d.find("svg"),f=0,g=e.length;f<g;f++)e[f].innerHTML="";a.data={},u(c).then(function(b){a.isNoData=!1,a.words=b.wordsdict,a.data[a.tabSelection]=b.data,n()})}})}function n(){"chart"===a.templateType&&d.find("svg").remove();var b=angular.copy(a.data[a.tabSelection]),e=a.contentType,f=a.templateType;if(a.data[a.tabSelection]={},a.isLoaded=!1,"summ"===f){var g=q(e),h=a.cwidth/b.pies.data.length+70,i=h<g?h:g;i=i>280?280:i,a.piechart_options={height:i,margin:{top:-.08*i,left:0},showControles:!0,showLegend:!1,showLabels:!1,tooltips:!1},a.piechart_colors=["#528be8","#d5dde0"]}else if("table"==f){for(var j=q(e).toString()+"px",k=a.options.slice(0),l="detailTableRegionMap"===e?[a.currentTitle]:[""],m=0,n=k.length;m<n;m++)"colms"===k[m].name&&(l=k[m].applied.title||[k[m].applied.label]),k[m].applied.children&&"colms"===k[m].applied.children.name&&(l=k[m].applied.children.applied.title||[k[m].applied.children.applied.label]);a.table_title=l,a.table_h=j,a.isLoaded=!0,a.isapploaded=!0}else if("chart"===f){var o={};o.height=q(e),o.width=a.cwidth,"eachpathpopup"===a.ctype&&(o.width-=60),"pieBrowsers"===e&&(o=s(o,b)),-1!==e.indexOf("logCountTrend",0)&&(o.margin={bottom:100},o.xAxis={rotateLabels:-45}),a.yaxis_title=b.yAxis_label||"",a.yaxis_labels=b.yAxis_values||[],a.xaxis_title=b.xAxis_label||"",void 0!==a.options[0]&&("bintype"===a.options[0].name||"distFreq"===e&&"xAxisType"===a.options[0].name)&&(a.xaxis_title=a.options[0].applied.label||a.xaxis_title),a.xaxis_labels=b.xAxis_values||[],a.chart_options=o,a.summary=b.summary||[],a.tailrate_title=b.tailrate_title,a.tailrate=b.tailrate,a.isshowlegendflg="distFreq"!==e,a.message=b.overmaxmessage||"",-1!==e.indexOf("logCountTrend",0)&&(a.chart_colors="logCountTrend"===e?["#72727a","#a0add3","#add8e6"]:["#72727a","#a0add3","#add8e6","#bfe1bf","#e0af82"])}r(e,i),(null!==navigator.userAgent.toString().match(/Win[0-9]/)||navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/MSID/))&&c(function(){a.isLoaded=!0,a.isapploaded=!0,a.isrunning=!1},10),a.data[a.tabSelection]=angular.copy(b),c(function(){r(e,i),a.isLoaded=!0,a.isapploaded=!0,a.isrunning=!1},500)}function o(){}function p(b){var c=0;return d.find(".summary_tabcont_"+a.contentType).find(".header-options").each(function(){var a=$(this).height();c+=b?a>0?a:80:a>0?a:0}),a.cheight}function q(a){var b=p(!0),c="distFreqPV"===a?50:0;return-1!==a.indexOf("Trend")&&(c=90),-1!==a.indexOf("distFreq")&&(c=120),-1!==a.indexOf("distFreqPV")&&(c=170),b-=c,"summ"===a?b/2*1.1:b-70}function r(a,b){"summ"===a&&c(function(){d.find(".pie-chart-label").css({"line-height":(.85*b).toString()+"px"})},10)}function s(a,b){return a.callback=function(a){var c=d.find("#pieBrowserDetailTooltip");$(".nv-slice").off("mouseover").on("mouseover",function(a){var c=$(this).parent().index();b.nvd3[c].key}),$(".nv-slice").off("mouseout").on("mouseout",function(a){c.hide()})},a}function t(b){for(var c=0,d=a.options.length;c<d;c++){var e=a.options[c];if("select"===e.type){var f=e.applied.value;if(b[e.name]=angular.isArray(f)?{arr:f}:f,e.applied.children){var g=e.applied.children.applied.value||e.applied.children.selected.value;b[e.applied.children.name]=angular.isArray(g)?{arr:g}:g}}else b[e.name]=e.applied}return"distToCV"===a.contentType&&(b.ctype="pathdist",b.tmpl="table"),b}function u(b){var c={uid:a.optglbl.uid,lid:a.optglbl.lid,sdate:a.optglbl.currentimported.start_date,edate:a.optglbl.currentimported.end_date,ctype:a.contentType,dtype:a.chartType,tmpl:a.templateType,redoflg:b?1:0};return void 0!==a.optglbl.pathpoints&&(c.paths={arr:a.optglbl.pathpoints}),c=t(c),g.getContents(c).$promise}a.$watchCollection(function(){return{isactive:a.isactive,cheight:a.cheight,cwidth:a.cwidth,optglbl:a.optglbl}},function(b,c){a.isLoaded=!1,a.isactive&&void 0!==a.optglbl&&a.cheight>100&&void 0!==a.cwidth&&a.optcont.isVisible&&(a.isLoaded=!1,void 0===a.options||void 0===a.data?f():n())}),a.$watchCollection("filterupdatecnt",function(){a.filterupdatecnt>0&&(a.isLoaded=!1,f())}),a.tabChange=function(b,c){(b!==a.tabSelection&&a.isLoaded&&!a.isviewmode||c)&&(a.isLoaded=!1,void 0===a.optpath[b].isCogCollapse&&(a.optpath[b].isCogCollapse=!0),k.put("gsindex_"+a.ctype,b),a.selectedIndex=b,a.isrunning=!0,a.isChanged=!1,d.find("svg").remove(),a.tabSelection=b,j(b),o(),m(!1))},a.returnIsDisabledItem=function(b,c){if(void 0!==c.disabled)for(var d=c.disabled,e=d.target,f=d.list,g=0,h=a.options.length;g<h;g++){var i=a.options[g].name;if(e===i){var j=a.options[g].selected;return-1!==$.inArray(j.value,f)}}return!1},a.setOptions=function(b,c,d){if(b.selected=$.extend(!0,{},c),b.selectedidx=d,b.selected.children){var e=b.selected.children.defaultindex||0;b.selected.children.selected=b.selected.children.list[e],b.selected.children.selectedidx=e}l(a.options),a.setIsChangedToApplyButton()},a.applySelection=function(b){if(a.isChanged=!1,"view"===b){a.isLoaded=!1,a.isapploaded=!1;for(var c=0,d=a.options.length;c<d;c++){a.options[c].applied=a.options[c].selected;var e=a.options[c].selectedidx||0;if(k.put(a.options[c].varname,e),a.options[c].applied.children){a.options[c].applied.children.applied=$.extend(!0,{},a.options[c].applied.children.selected),k.put(a.options[c].selected.children.varname,a.options[c].selected.children.selectedidx);for(var f=0,g=a.options[c].list.length;f<g;f++)if(void 0===a.options[c].list[f].children.applied){var h=$.extend(!0,{},a.options[c].list[f].children);delete h.selected,delete h.applied,a.options[c].list[f].children=$.extend(!0,{},h)}}}m(!1)}"dl"===b&&a.downloadTable()},a.forceRun=function(){a.isLoaded=!1,m(!0)},a.setIsChangedToApplyButton=function(){for(var b=!1,c=0,d=a.options.length;c<d;c++){var e=a.options[c];"select"===e.type?(b=e.applied.value!=e.selected.value||b,e.applied.children&&(b=!e.selected.children.applied||(e.selected.children.selected.value!=e.selected.children.applied.value||b))):b=e.applied!=e.selected||b}a.isChanged=b},a.downloadTable=function(){var b={uid:a.optglbl.uid,lid:a.optglbl.lid,sdate:a.optglbl.currentimported.start_date,edate:a.optglbl.currentimported.end_date,ctype:a.contentType,dtype:a.chartType,tmpl:a.templateType,csvflg:!0};void 0!==a.optglbl.pathpoints&&(b.paths={arr:a.optglbl.pathpoints}),b=t(b),location.href=h+"/"+e.getContents+"?"+$.param(b)}},controller:["$scope","$element",function(a,b){a.isLoaded=!1,a.isrunning=!1,a.isNoData=!1,a.tabSelection=-1,a.fuploadcnt=[]}]}}]),angular.module("auriqCJPath").filter("ellipsedStringCjpath",["$timeout",function(a){function b(a,b){for(var c,d=document.getElementById("ruler-"+b);c=d.lastChild;)d.removeChild(c);var e=d.appendChild(document.createTextNode(a)),f=d.offsetWidth;return d.removeChild(e),f}function c(a,c,d){if(0===c)return a;for(var e="",f=a.length,g=0;g<f;g++){e+=a[g];var h=b(e,d);if((h=h<6*(g+1)?6*(g+1):h)>c)return e.slice(0,-1)+"..."}return a}return function(a,b,d){var d=parseInt(d)
;return void 0!==a&&c(a,d,b)}}]).controller("logSampleDialogCtrl",["$scope","$uibModalInstance","urlsFactory","API","API_BASE","items","$window",function(a,b,c,d,e,f,g){function h(b){a.isLoaded=!1,b.cvusrflg=a.isCVUserOnly?1:0,b.csvflg=!1,d.getContents(b).$promise.then(function(b){a.isLoaded=!0,a.tabledata=b.data})}var i=f;a.words=f.words,a.isCVUserOnly=!0,a.isLoaded=!1,h(i),a.changeCVUserOnlyStatus=function(){a.isCVUserOnly=!a.isCVUserOnly,h(i)},a.tableWrapperStyle={"max-height":angular.element(g).outerHeight()-250},a.download=function(){var b=angular.copy(f);b.csvflg=!0,b.cvusrflg=parseInt(a.dlpattern),location.href=e+"/"+c.getContents+"?"+$.param(b)},a.close=function(){b.dismiss("cancel")}}]).controller("detailedPathInfoCtrl",["$scope","$uibModalInstance","urlsFactory","API","items","$window","$timeout",function(a,b,c,d,e,f,g){function h(){g(function(){a.params.summary_w=angular.element(document.querySelector(".detailSampleWrapper")).outerWidth()})}a.params=angular.copy(e),a.masterflg=e.masterflg,a.heights={upper:150,bottom:520},g(function(){a.params.summary_w=angular.element(document.querySelector(".detailSampleWrapper")).outerWidth()});var i;angular.element(f).bind("resize",function(){clearTimeout(i),i=setTimeout(h,500)}),a.close=function(){b.dismiss("cancel")}}]).directive("drawCjPath",["d3Service","colorsFactory","API","API_BASE","urlsFactory","$parse","$rootScope","$timeout","$uibModal","$cookies","$window","$q",function(a,b,c,d,e,f,g,h,i,j,k,l){return{restrict:"EA",templateUrl:"views/directives/templ-draw-cjpath.html",scope:{optcont:"=",pathdata:"=",symbols:"=",appheight:"=",optglbl:"=",optpath:"=",words:"=",isviewmode:"=",masterflg:"=",drawpattern:"="},link:function(a,b,c,d){function e(a){var b=document.getElementById(a);return b?b.offsetWidth:0}function f(){var b=l.defer();a.maxvalues={};for(var c=["trg_cnt","rfr_cnt","cvrate"],d=0,f=a.pathdata.length;d<f;d++)for(var g=0,i=c.length;g<i;g++){var j=c[g],k=a.pathdata[d][j].value;a.maxvalues[j]||(a.maxvalues[j]={value:-999}),a.maxvalues[j].value<k&&(a.maxvalues[j]=a.pathdata[d][j])}return h(function(){a.cnt_all_w=e("ruler-cjpath-usercnt"),a.cnt_cv_w=e("ruler-cjpath-cvusercnt"),a.rate_cv=e("ruler-cjpath-cvrate");var d=e("ruler-cjpath-leftbox")+10,f=0;a.leftbox_w=d<f?f:d,h(function(){for(var b=0,d=c.length;b<d;b++)a.maxvalues[c[b]]=""}),b.resolve()}),b.promise}function g(){for(var c=1==a.optpath.cutoption.value,d=0==a.optpath.pathstartpoint.value,e=!0===d&&!0===c,f=a.optpath.cutlen,g=50,h="main"===a.drawpattern?".contentField":".detailSampleInner",i=angular.element(b).closest(h).outerWidth()-a.leftbox_w,j=0,k=a.pathdata.length;j<k;j++){var l=a.pathdata[j],m=l.trg_cnt.value,n=(l.cvrate.value,e&&m>0);a.pathdata[j].isDrawDummyCV=n,a.pathdata[j].styleEachTouchPath={width:"calc( (100% - "+g+"px) / "+(l.path.length-1)+")"},a.pathdata[j].styleLastTouchPath={width:g+"px"};var o=l.path.length>0?l.path[l.path.length-1].colorKey:"";a.pathdata[j].isCutBeforeCV=l.path.length<=f&&"fakecv"===o,a.pathdata[j].drawSpanNum=l.path.length-1;var p=40,q=i/(l.path.length+1)-10;a.pathdata[j].radius=q>p?p:q,a.pathdata[j].mrgtop=(p-a.pathdata[j].radius)/2}}function j(){f().then(function(){g()}),a.css_icon_toopendetail={"margin-top":(a.appheight/a.optpath.pagerange-20-30)/2+"px"};var b="main"===a.drawpattern?a.optpath.pagerange:1;a.css_each_row={height:a.appheight/b+"px"}}function m(a,b,c){var d=angular.copy(c);return i.open({animation:!0,templateUrl:b,controller:a,size:"lg",resolve:{items:function(){return d}}})}var n;a.$watchCollection("pathdata",function(){void 0!==a.pathdata&&j()}),a.$watchCollection("optcont.isfullscreen",function(){a.fullscreenFlg=!!a.optcont&&a.optcont.isfullscreen,void 0!==a.fullscreenFlg&&(h(function(){for(var b=0,c=angular.element(document.querySelectorAll(".header-options, .widget-header, .fullscreenWrapperPath")),d=0,e=c.length;d<e;d++)b+=angular.element(c[d]).outerHeight();a.field_h=angular.element(k).outerHeight()-b-100,angular.element(".cjpath-content-wrapper")[0].scrollTop=0}),f())}),a.hover_touchpoint=function(b,c){var b=a.drawpattern+"-"+b,d=".cjpath-path-each-touchpoint-standard";"in"===c&&(angular.element(document.querySelectorAll(d+".hovertp")).removeClass("hovertp"),angular.element(document.querySelectorAll(d+"."+b)).addClass("hovertp")),"out"===c&&angular.element(document.querySelectorAll(d+".hovertp")).removeClass("hovertp")},a.open_detail=function(b){a.isviewmode||(n={isshowapp:!0,pathdata:[b],leftboxsizes:{cnt_all_w:a.cnt_all_w,cnt_cv_w:a.cnt_cv_w,rate_cv:a.rate_cv,leftbox_w:a.leftbox_w-30},optcont:a.optcont,symbols:a.symbols,currentimported:a.optglbl.global.currentimported,pathpoints:b.original_path_arr,uid:a.optglbl.uid,lid:a.optglbl.lid,isviewmode:a.isviewmode,wordsdict:a.words.each_path_popup,optpath:a.optpath,masterflg:a.masterflg,words:a.words},m("detailedPathInfoCtrl","views/modals/cjpath-eachdetails.html",n).result.then(function(a){},function(){}))},a.open_sample_log=function(b){if(!a.isviewmode){m("logSampleDialogCtrl","views/modals/cjpath-log-sample.html",{uid:a.optglbl.uid,lid:a.optglbl.lid,ctype:"dump",tmpl:"dump",paths:{arr:b.original_path_arr},topx:1,words:a.words,isviewmode:a.isviewmode,csvflg:!1}).result.then(function(a){},function(){})}}},controller:["$scope",function(a){a.isLoaded=!1}]}}]).directive("d3PathToConv",["d3Service","colorsFactory","API","API_BASE","urlsFactory","$parse","$rootScope","$timeout","$uibModal","$cookies","$window",function(a,b,c,d,e,f,g,h,i,j,k){a.d3;return{restrict:"EA",templateUrl:"views/directives/templ-path-cj-paths.html",scope:{isapploaded:"=",optglbl:"=",optpath:"=",optcont:"=",isessready:"=",masterflg:"=",isviewmode:"="},link:function(a,b,f,g){function i(){$(b).find("svg").remove(),b.find("svg").remove()}function k(){a.alldata=[],a.noData=!1,l().then(function(b){a.words=b.wordsdict,v(b.data.pagemax),0===b.data.d3objs.length?(a.isLoaded=!0,a.isapploaded=!0,a.noData=!0,a.isrunning=!1):q(b),a.isLoaded=!0,a.isapploaded=!0,a.isrunning=!1})}function l(){a.isapploaded=!1,a.isLoaded=!1;var b=m();return B=$.extend(!0,{},b),c.getContents(b).$promise}function m(){return{uid:a.optglbl.uid,lid:a.optglbl.lid,ctype:"path",tmpl:"path",tptype:a.optpath.trajectoryType,paging:a.optpath.options.paging,tpdepth:a.tpdepth,fldepth:a.filterdepth,filter:a.optpath.filterFirstTp,dist:a.freq.value,csvflg:!1}}function n(){i(),o().then(function(b){if(a.optpath.filterFirstTp="",a.optpath.options={paging:b.paging},void 0===a.pathorder){var c=a.optpath.pathorderflg.value;a.pathorder_options=a.optpath.pathorderflg.options;for(var d=0,e=a.pathorder_options.length;d<e;d++)a.pathorder=a.pathorder_options[d].value===parseInt(c)?a.pathorder_options[d]:a.pathorder;a.temppathorder=a.pathorder,a.pathorderDescription=a.optpath.pathorderflg.description}if(void 0===a.tillCVList){var f=a.optpath.tillcvflg.value,g={};f=""===f?1:f;for(var h=a.optpath.tillcvflg.options,d=0,e=h.length;d<e;d++)h[d].active=h[d].value===parseInt(f),g=h[d].value===parseInt(f)?h[d]:g;a.tillcv=g,a.temptillcv=g,a.tillCVList=h,a.tillcvDescription=a.optpath.tillcvflg.description}if(void 0===a.freqlist){a.freqlist=a.optpath.freqdetail.options;var i=parseInt(j.get("path_freqidx"))||0;a.freq=a.freqlist[i],a.freqDescription=a.optpath.freqdetail.description}if(void 0===a.touchPointDepthOptions){a.touchPointDepthOptions=a.optpath.pathdepth.options;var l=a.optpath.pathdepth.value,m=parseInt(j.get("path_tpdepth"))||l;a.tpdepth=-1!==a.touchPointDepthOptions.indexOf(m)?m:l}if(void 0===a.searchPathDepth){a.searchPathDepth=a.optpath.searchbykeywords.options;var n=parseInt(j.get("path_skidx"))||a.optpath.searchbykeywords.defidx;a.filterdepthlabel=a.searchPathDepth[n].label,a.filterdepth=a.searchPathDepth[n].value,a.filterdepthguide=a.searchPathDepth[n].defstr}z[a.tabSelection]=b,r().then(function(a){s(a.data.tbody),k()})})}function o(){a.isLoaded=!1,a.isapploaded=!1;var b={uid:a.optglbl.uid,lid:a.optglbl.lid,fldepth:a.filterdepth,filter:a.optpath.filterFirstTp,opttype:"cvpathpaging"};return c.getOptions(b).$promise}function p(){for(var a=["tpdepth","filter","fldepth","dist"],b=m(),c=B,d=!0,e=0,f=a.length;e<f;e++){var g=a[e];if("filter"===g&&(d=""===b[g]),void 0===b[g])return!0;if(b[g]!=c[g]){if("fldepth"!==g)return!0;if(!d)return!0}}return!1}function i(){a.totals={},$(b).find("svg").remove(),b.find("svg").remove()}function q(b){void 0===a.optpath.options.paging.status.pageNum&&w();var c=b.data;a.totals=c.totals,a.c_h=(A+5)*a.optpath.options.paging.range,a.maindata=angular.copy(c.d3objs),a.symbols=c.symbols,a.pathdetailoption={pathstartpoint:a.temppathorder,cutoption:a.temptillcv,cutlen:a.tpdepth,pagerange:a.optpath.options.paging.range}}function r(){return c.getFilters({uid:a.optglbl.uid,lid:a.optglbl.lid,gettype:"detail",type:"userintselect",pattern:"cvpath",esspara:"pathtpdef",setid:-1}).$promise}function s(b){var c=a.optpath.pathdepth.value,d=parseInt(j.get("path_tpdepth"))||c;a.tpdepth=-1!==a.touchPointDepthOptions.indexOf(d)?d:c,a.tpdepth_temp=a.tpdepth;var e=parseInt(j.get("path_skidx"))||a.optpath.searchbykeywords.defidx;a.filterdepthlabel=a.searchPathDepth[e].label,a.filterdepth=a.searchPathDepth[e].value,a.filterdepthguide=a.searchPathDepth[e].defstr;if(0===b.length)return a.noParameterAvailable=!0,!1;a.noParameterAvailable=!1;for(var f=b[0].colms,g={uniqueid:t(f,"id"),label:t(f,"setname"),value:t(f,"setactiveflg"),setid:t(f,"setid")},h=[],i={},k=!1,l=0,m=b.length;l<m;l++){f=b[l].colms;var n=f[g.uniqueid].value,o=f[g.label].value,p=f[g.value].value,q=f[g.setid].value,r={label:o,id:n.toString(),uniqueid:n.toString().split(",")[0],exception:n.toString().split(",").length>1?"setname":"none",esspara:"pathtpdef",setid:q,type:"setactiveflg",value:parseInt(p)};h.push(r),i=1===parseInt(p)?r:i,k=1===parseInt(p)||k}k||(h[0].value=1,i=h[0]),a.filterbuildpathobj=$.extend(!0,{},i),a.tempfilterbuildpathobj=$.extend(!0,{},i),k||(a.filterbuildpathobj.label=""),a.filterbuildpathlist=h,a.isSelectedExist=k}function t(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c].type===b)return c}function u(){c.essInstance({uid:a.optglbl.uid,lid:a.optglbl.lid,dotype:"check",trgtype:"import"}).$promise.then(function(a){"done"===a.status?n():h(function(){u()},1e3)})}function v(b){void 0!==b&&(a.optpath.options.paging.max=b,a.pageProp=y())}function w(){var b=y(),c=b.pageMin;a.pageProp=b,x(c)}function x(c){var c=(a.tabSelection,parseFloat(c)),d=y(),e=(d.pageMax,d.pageMin,d.itemRng);a.pagenum=c,b.find("#pagenumber-id").val(c),a.optpath.options.paging.status.pageNum=c,a.optpath.options.paging.status.from=(c-1)*e+1,a.optpath.options.paging.status.to=c*e}function y(){var b=(a.tabSelection,a.optpath.options.paging.max),c=a.optpath.options.paging.range;return{itemMax:b,itemMin:parseFloat(a.optpath.options.paging.min),itemRng:c,pageMax:Math.ceil(b/c),pageMin:1}}var z={},A=86,B={};a.noParameterAvailable=!0,a.isSelectedExist=!0,a.$watchCollection(function(){return{optionsisvisible:a.optcont.isVisible,optglbl:a.optglbl,isessready:a.isessready}},function(){if(a.optglbl){if(!a.optcont.isVisible)return a.isLoaded=!1,void(a.totals={});if(i(),a.isLoaded=!1,!0===a.isessready&&!1===a.isrunning){a.isapploaded=!1;void 0!==a.optglbl.global&&a.optglbl.global.lang;a.isrunning=!0,n()}}if(!a.optglbl||0===Object.keys(a.optglbl).length||!1===a.optcont.isVisible||!1===a.isessready)return a.isLoaded=!1,void(a.totals={});if(i(),a.isLoaded=!1,!0===a.isessread&&!1===a.isrunning){a.isapploaded=!1;void 0!==a.optglbl.global&&a.optglbl.global.lang;a.isrunning=!0,n()}}),a.$watchCollection("fuploadcnt",function(b,d){b!=d&&a.fuploadcnt.length>0&&(a.isLoaded=!1,a.isapploaded=!1,c.essUdbd({uid:a.optglbl.uid,lid:a.optglbl.lid,cmdtype:"profile"}).$promise.then(function(){a.isessread=!1}))}),a.pageChanged=function(b){var c=parseFloat(a.optpath.options.paging.status.pageNum),d="n"===b?c+1:c-1;d<0&&(d=0),c!==d&&a.isLoaded&&(x(d),i(),k())},a.pageChangeByNum=function(c,d){a.tabSelection;if("keydown"===c.type&&-1!==$.inArray(c.keyCode,[9,13])||"blur"===c.type){var e=a.optpath.options.paging.status.pageNum;d=isFinite(d)?parseInt(d):e,d=d>0&&d<=a.pageProp.pageMax?d:e,d!=e?(x(d),i(),k()):(b.find("#pagenumber-id").val(d),a.pagenum=d)}},a.changeTouchPointDepth=function(b){a.tpdepth_temp=b},a.csvall=function(){var b=a.optpath.filterFirstTp,c={uid:a.optglbl.uid,lid:a.optglbl.lid,ctype:"path",tmpl:"path",tptype:a.optpath.trajectoryType,paging:{status:{from:1,to:1e4}},tpdepth:a.tpdepth,fldepth:a.filterdepth,filter:b,dist:a.freq.value,csvflg:!0};location.href=d+"/"+e.getContents+"?"+$.param(c)},a.filterOptionPanel=function(){a.isCollapsed=!a.isCollapsed},a.applyFilterOption=function(){a.pagenum=1,b.find("#pagenumber-id").val(1),a.pathorder=$.extend(!0,{},a.temppathorder),a.tillcv=$.extend(!0,{},a.temptillcv),a.tpdepth=a.tpdepth_temp,j.put("path_tpdepth",a.tpdepth);var d={uid:a.optglbl.uid,lid:a.optglbl.lid,pathord:a.pathorder.value,tocv:a.tillcv.value,cmdtype:"calpath"},e=a.filterbuildpathobj,f=a.tempfilterbuildpathobj;if(e.label!==f.label){e.value=0,f.value=1,e.operation="update",f.operation="update",e.names=["setactiveflg"],f.names=["setactiveflg"],e.values=[0],f.values=[1],delete e.label,delete e.esspara,delete e.exception,delete e.setid,delete e.type,delete e.uniqueid,delete e.value,delete f.label,delete f.esspara,delete f.exception,delete f.setid,delete f.type,delete f.uniqueid,delete f.value;var g={uid:a.optglbl.uid,lid:a.optglbl.lid,filterSelection:JSON.stringify([e,f]),type:"pathtpdef",pattern:"cvpath"};a.iscollapsed=!a.iscollapsed,a.isLoaded=!1,a.isapploaded=!1,c.saveFilters(g).$promise.then(function(){a.filterbuildpathobj=$.extend(!0,{},a.tempfilterbuildpathobj),c.essUdbd(d).$promise.then(function(){u()})})}else a.isLoaded=!1,a.isapploaded=!1,c.essUdbd(d).$promise.then(function(){u()})},a.forceRedoCalc=function(){a.isLoaded=!1;var b={uid:a.optglbl.uid,lid:a.optglbl.lid,pathord:a.pathorder.value,tocv:a.tillcv.value,cmdtype:"calpath"};c.essUdbd(b).$promise.then(function(){u()})},a.changeListSelection=function(b){a.temptillcv=b},a.applyQuery=function(b){(void 0===b||"keydown"===b.type&&-1!==$.inArray(b.keyCode,[9,13])||"blur"===b.type)&&p()&&(a.optpath.isCollapsed=!1,w(),i(),k())},a.changeFilteBuildPath=function(b,c){a.tempfilterbuildpathobj=$.extend(!0,{},a.filterbuildpathlist[b])},a.changePathBuildType=function(b){a.temppathorder=b}},controller:["$scope",function(a){a.isLoaded=!1,a.isrunning=!1,a.tabSelection=0,a.fuploadcnt=[],a.isCollapsed=!0}]}}]),angular.module("auriqCJPath").controller("detailStatOfLoadedDataCtrl",["$scope","$uibModalInstance","items",function(a,b,c){a.datadict=angular.copy(c.datadict),a.logtypes=angular.copy(c.logtypes),a.counttypes=angular.copy(c.counttypes),a.datatypes=angular.copy(c.datatypes),a.cancel=function(){b.dismiss("cancel")}}]).directive("essLoadedDataView",["d3Service","colorsFactory","API","API_BASE","urlsFactory","$parse","$timeout","$uibModal",function(a,b,c,d,e,f,g,h){a.d3;return{restrict:"EA",templateUrl:"views/directives/templ-ess-loaded-data-view.html",scope:{uid:"=",lid:"=",isessready:"="},link:function(a,b){function d(){var b={uid:a.uid,lid:a.lid,ctype:"essloadedsumm",tmpl:"essloadedsumm"};a.isLoaded=!1,c.getContents(b).$promise.then(function(b){a.words=b.wordsdict.title_essamountviewer,a.datadict=b.data.datadict,a.logtypes=b.data.logtypes,a.counttypes=b.data.counttypes,a.datatypes=b.data.datatypes,a.lang=b.data.lang,a.isLoaded=!0},function(a){item.type&&alert('Disactivate "adblock" to show the summary for "Ad".')})}a.$watchCollection(function(){return{isessready:a.isessready,uid:a.uid,lid:a.lid}},function(){1==a.isessready&&a.isLoaded&&a.uid&&a.lid&&(a.isLoaded=!1,d())}),a.openclose=function(b){a.isCollapse="close"===b},a.openDetailStatOfLoadedData=function(){h.open({animation:!0,templateUrl:"views/modals/ess-loaded-summary.html",controller:"detailStatOfLoadedDataCtrl",size:"lg",resolve:{items:function(){return{datadict:a.datadict,logtypes:a.logtypes,counttypes:a.counttypes,datatypes:a.datatypes}}}}).result.then(function(a){},function(){})}},controller:["$scope",function(a){a.isCollapse=!0,a.isLoaded=!0}]}}]),angular.module("auriqCJPath").directive("viewCalcSetting",["colorsFactory","$timeout","$filter","urlsFactory","$http","API","$rootScope","$window",function(a,b,c,d,e,f,g,h){return{restrict:"EA",templateUrl:"views/directives/templ-path-view-calcsetting.html",scope:{optglbl:"=",iscollapsed:"=",issidebaropened:"="},link:function(a,b){function c(){a.isLoaded=!1,d().then(function(b){a.words=b.wordsdict,e(b.data),a.isLoaded=!0})}function d(){var b={uid:a.optglbl.uid,lid:a.optglbl.lid,gettype:"infoview",sdate:a.optglbl.global.currentimported.start_date,edate:a.optglbl.global.currentimported.end_date};return f.getFilters(b).$promise}function e(b){a.tbody=b.tbody,a.thead=b.thead}a.$watchCollection(function(){return{iscollapsed:a.iscollapsed}},function(){!a.iscollapsed&&"global"in a.optglbl&&c()}),a.close=function(){a.iscollapsed=!a.iscollapsed}},controller:["$scope","$element",function(a,b){a.isLoaded=!1}]}}]);